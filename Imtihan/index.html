<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تقييم حفظ الطلاب - المجمع القرآني حمزة بن عبدالمطلب</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="https://i.ibb.co/jZrxhFsf/1-min.png" type="image/png">
    <style>
        :root {
            --primary-color: #1a4d2e;
            --primary-dark: #0e3a23;
            --secondary-color: #f5f5dc;
            --accent-color: #4a7856;
            --text-color: #333;
            --light-bg: #f9f9f7;
            --gold-color: #d4af37;
            --error-color: #e74c3c;
            --success-color: #2ecc71;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
        }

        header {
            background: linear-gradient(rgba(26, 77, 46, 0.95), rgba(26, 77, 46, 0.95)),
                        url('https://img.freepik.com/free-vector/abstract-islamic-golden-pattern-backdrop-ethnic-style_1017-54276.jpg') center/cover;
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            width: 100%;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .logo {
            width: 150px;
            margin: 0.5rem auto;
            filter: drop-shadow(0 2px 5px rgba(0,0,0,0.3));
        }

        header h1 {
            margin: 0.5rem 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            font-size: 1.8rem;
            line-height: 1.3;
            font-weight: 700;
        }

        .container {
            max-width: 1000px;
            margin: 3rem auto;
            padding: 0 1.5rem;
        }

        .evaluation-form {
            background: white;
            border-radius: 15px;
            padding: 2.5rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }

        .form-title {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.8rem;
            font-weight: 800;
            position: relative;
        }

        .form-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 50%;
            transform: translateX(50%);
            width: 80px;
            height: 4px;
            background: var(--gold-color);
            border-radius: 3px;
        }

        .section-title {
            color: var(--primary-dark);
            margin: 2rem 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--gold-color);
            font-size: 1.3rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--primary-dark);
        }

        .form-control {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 77, 46, 0.2);
        }

        .radio-group {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .radio-option {
            display: flex;
            align-items: center;
        }

        .radio-option input {
            margin-left: 0.5rem;
        }

        .select-group {
            position: relative;
        }

        .select-group select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1em;
        }

        .error-message {
            color: var(--error-color);
            font-size: 0.9rem;
            margin-top: 0.3rem;
            display: none;
        }

        .submit-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
            width: 100%;
            margin-top: 2rem;
        }

        .submit-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .form-note {
            text-align: center;
            margin-top: 1.5rem;
            color: #666;
            font-size: 0.9rem;
        }

        footer {
            background-color: var(--primary-dark);
            color: white;
            padding: 2rem 0;
            text-align: center;
            margin-top: 3rem;
        }

        .copyright {
            font-size: 0.9rem;
            color: #ccc;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .success-icon {
            color: var(--success-color);
        }

        .error-icon {
            color: var(--error-color);
        }

        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary-dark);
        }

        .modal-message {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }

        .modal-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-btn:hover {
            background: var(--primary-dark);
        }

        .spinner {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255,255,255,0.8);
            z-index: 100;
            border-radius: 15px;
            justify-content: center;
            align-items: center;
        }

        .spinner-inner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* أنماط الجدول */
        .students-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.9rem;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        .students-table thead tr {
            background-color: var(--primary-dark);
            color: white;
            text-align: right;
        }

        .students-table th,
        .students-table td {
            padding: 12px 15px;
            text-align: right;
        }

        .students-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }

        .students-table tbody tr:nth-of-type(even) {
            background-color: #f3f3f3;
        }

        .students-table tbody tr:last-of-type {
            border-bottom: 2px solid var(--primary-dark);
        }

        .students-table tbody tr:hover {
            background-color: #e6f7e6;
        }

        .hizb-input {
            width: 60px;
            padding: 5px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .semester-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #ddd;
        }

        .semester-tab {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .semester-tab.active {
            color: var(--primary-dark);
            border-bottom: 3px solid var(--gold-color);
        }

        .semester-tab:hover:not(.active) {
            color: var(--primary-color);
            background-color: #f5f5f5;
        }

        .semester-content {
            display: none;
        }

        .semester-content.active {
            display: block;
        }

        .report-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 2rem;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
        }

        .report-title {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--gold-color);
        }

        .report-stats {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stat-box {
            background: var(--light-bg);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            flex: 1;
            min-width: 150px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-dark);
            margin: 0.5rem 0;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .positive {
            color: var(--success-color);
        }

        .negative {
            color: var(--error-color);
        }

        .teacher-select {
            margin-bottom: 2rem;
        }

        @media (max-width: 768px) {
            .container {
                margin: 2rem auto;
                padding: 0 1rem;
            }
            
            .evaluation-form {
                padding: 1.5rem;
            }
            
            header h1 {
                font-size: 1.5rem;
            }
            
            .form-title {
                font-size: 1.5rem;
            }

            .students-table {
                font-size: 0.8rem;
            }

            .students-table th,
            .students-table td {
                padding: 8px 10px;
            }

            .hizb-input {
                width: 50px;
            }

            .report-stats {
                flex-direction: column;
            }

            .stat-box {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <img src="https://i.ibb.co/jZrxhFsf/1-min.png" alt="شعار المدرسة" class="logo">
        <h1>تقييم حفظ الطلاب للقرآن الكريم</h1>
    </header>

    <main class="container">
        <div class="evaluation-form">
            <h2 class="form-title">سجل استظهار الطلاب للقرآن الكريم</h2>
            
            <div class="teacher-select">
                <div class="form-group">
                    <label for="teacherName">اسم المعلم <span class="required">*</span></label>
                    <select id="teacherName" class="form-control" required>
                        <option value="">-- اختر اسم المعلم --</option>
                        <option value="teacher1">الأستاذ محمد أحمد</option>
                        <option value="teacher2">الأستاذ علي محمود</option>
                        <option value="teacher3">الأستاذة فاطمة الزهراء</option>
                        <option value="teacher4">الأستاذ عمر عبد الله</option>
                    </select>
                    <div class="error-message" id="teacherNameError">يجب اختيار اسم المعلم</div>
                </div>
            </div>
            
            <div class="semester-tabs">
                <div class="semester-tab active" data-semester="first">السداسي الأول</div>
                <div class="semester-tab" data-semester="second">السداسي الثاني</div>
            </div>
            
            <div class="semester-content active" id="firstSemester">
                <div class="form-group">
                    <label>تاريخ التقييم للسداسي الأول <span class="required">*</span></label>
                    <input type="date" id="firstSemesterDate" class="form-control" required>
                    <div class="error-message" id="firstSemesterDateError">يجب إدخال تاريخ التقييم</div>
                </div>
                
                <div class="table-responsive">
                    <table class="students-table">
                        <thead>
                            <tr>
                                <th>رقم التسجيل</th>
                                <th>اسم الطالب</th>
                                <th>لقب الطالب</th>
                                <th>عدد الأحزاب المحفوظة</th>
                                <th>ملاحظات</th>
                            </tr>
                        </thead>
                        <tbody id="firstSemesterStudents">
                            <!-- سيتم ملء هذا الجدول بالبيانات من Firebase -->
                            <tr>
                                <td>20230615-1234</td>
                                <td>أحمد</td>
                                <td>محمد</td>
                                <td><input type="number" class="hizb-input" min="0" max="60" value="5"></td>
                                <td><input type="text" class="form-control" placeholder="ملاحظات"></td>
                            </tr>
                            <tr>
                                <td>20230615-1235</td>
                                <td>فاطمة</td>
                                <td>علي</td>
                                <td><input type="number" class="hizb-input" min="0" max="60" value="8"></td>
                                <td><input type="text" class="form-control" placeholder="ملاحظات"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <button type="button" class="submit-btn" id="saveFirstSemester">حفظ بيانات السداسي الأول</button>
            </div>
            
            <div class="semester-content" id="secondSemester">
                <div class="form-group">
                    <label>تاريخ التقييم للسداسي الثاني <span class="required">*</span></label>
                    <input type="date" id="secondSemesterDate" class="form-control" required>
                    <div class="error-message" id="secondSemesterDateError">يجب إدخال تاريخ التقييم</div>
                </div>
                
                <div class="table-responsive">
                    <table class="students-table">
                        <thead>
                            <tr>
                                <th>رقم التسجيل</th>
                                <th>اسم الطالب</th>
                                <th>لقب الطالب</th>
                                <th>عدد الأحزاب المحفوظة</th>
                                <th>ملاحظات</th>
                            </tr>
                        </thead>
                        <tbody id="secondSemesterStudents">
                            <!-- سيتم ملء هذا الجدول بالبيانات من Firebase -->
                            <tr>
                                <td>20230615-1234</td>
                                <td>أحمد</td>
                                <td>محمد</td>
                                <td><input type="number" class="hizb-input" min="0" max="60" value="12"></td>
                                <td><input type="text" class="form-control" placeholder="ملاحظات"></td>
                            </tr>
                            <tr>
                                <td>20230615-1235</td>
                                <td>فاطمة</td>
                                <td>علي</td>
                                <td><input type="number" class="hizb-input" min="0" max="60" value="15"></td>
                                <td><input type="text" class="form-control" placeholder="ملاحظات"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <button type="button" class="submit-btn" id="saveSecondSemester">حفظ بيانات السداسي الثاني</button>
            </div>
            
            <div class="report-card">
                <h3 class="report-title">تقرير تقدم الطلاب</h3>
                
                <div class="form-group">
                    <label for="studentSelect">اختر طالباً لعرض تقريره</label>
                    <select id="studentSelect" class="form-control">
                        <option value="">-- اختر طالبا --</option>
                        <option value="20230615-1234">أحمد محمد</option>
                        <option value="20230615-1235">فاطمة علي</option>
                    </select>
                </div>
                
                <div id="studentReport" style="display: none;">
                    <div class="report-stats">
                        <div class="stat-box">
                            <div class="stat-label">عدد الأحزاب في السداسي الأول</div>
                            <div class="stat-value" id="firstSemesterHizb">5</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">عدد الأحزاب في السداسي الثاني</div>
                            <div class="stat-value" id="secondSemesterHizb">12</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">عدد الأحزاب الإضافية</div>
                            <div class="stat-value positive" id="additionalHizb">+7</div>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 1.5rem;">
                        <label>ملاحظات عامة</label>
                        <textarea id="generalNotes" class="form-control" rows="3" readonly></textarea>
                    </div>
                </div>
            </div>
            
            <div class="spinner" id="formSpinner">
                <div class="spinner-inner"></div>
            </div>
        </div>
    </main>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <i class="fas fa-check-circle modal-icon success-icon"></i>
            <h3 class="modal-title">تم الحفظ بنجاح</h3>
            <p class="modal-message" id="successMessage">تم حفظ بيانات التقييم بنجاح في قاعدة البيانات.</p>
            <button class="modal-btn" id="successBtn">حسناً</button>
        </div>
    </div>

    <!-- Error Modal -->
    <div class="modal" id="errorModal">
        <div class="modal-content">
            <i class="fas fa-times-circle modal-icon error-icon"></i>
            <h3 class="modal-title">حدث خطأ</h3>
            <p class="modal-message" id="errorMessage">حدث خطأ أثناء محاولة حفظ البيانات. يرجى المحاولة مرة أخرى.</p>
            <button class="modal-btn" id="errorBtn">حسناً</button>
        </div>
    </div>

    <footer>
        <div class="copyright">
            <p>جميع الحقوق محفوظة &copy; المجمع القرآني حمزة بن عبدالمطلب <span id="year"></span></p>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // تعيين سنة حقوق النشر
            document.getElementById('year').textContent = new Date().getFullYear();
            
            // تبويبات السداسي
            const semesterTabs = document.querySelectorAll('.semester-tab');
            semesterTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // إزالة النشط من جميع الألسنة
                    semesterTabs.forEach(t => t.classList.remove('active'));
                    // إضافة النشط للسان المحدد
                    this.classList.add('active');
                    
                    // إخفاء جميع محتويات السداسيات
                    document.querySelectorAll('.semester-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // إظهار محتوى السداسي المحدد
                    const semester = this.getAttribute('data-semester');
                    document.getElementById(semester + 'Semester').classList.add('active');
                });
            });
            
            // عرض تقرير الطالب
            document.getElementById('studentSelect').addEventListener('change', function() {
                const studentId = this.value;
                if (studentId) {
                    // هنا يجب جلب بيانات الطالب من Firebase
                    // هذه بيانات وهمية للتوضيح فقط
                    const firstSemesterHizb = 5;
                    const secondSemesterHizb = 12;
                    const additionalHizb = secondSemesterHizb - firstSemesterHizb;
                    
                    document.getElementById('firstSemesterHizb').textContent = firstSemesterHizb;
                    document.getElementById('secondSemesterHizb').textContent = secondSemesterHizb;
                    document.getElementById('additionalHizb').textContent = 
                        (additionalHizb >= 0 ? '+' : '') + additionalHizb;
                    document.getElementById('additionalHizb').className = 
                        'stat-value ' + (additionalHizb >= 0 ? 'positive' : 'negative');
                    
                    document.getElementById('studentReport').style.display = 'block';
                } else {
                    document.getElementById('studentReport').style.display = 'none';
                }
            });
            
            // حفظ بيانات السداسي الأول
            document.getElementById('saveFirstSemester').addEventListener('click', function() {
                saveSemesterData('first');
            });
            
            // حفظ بيانات السداسي الثاني
            document.getElementById('saveSecondSemester').addEventListener('click', function() {
                saveSemesterData('second');
            });
            
            function saveSemesterData(semester) {
                const teacherName = document.getElementById('teacherName').value;
                const semesterDate = document.getElementById(semester + 'SemesterDate').value;
                
                if (!teacherName) {
                    document.getElementById('teacherNameError').style.display = 'block';
                    return;
                } else {
                    document.getElementById('teacherNameError').style.display = 'none';
                }
                
                if (!semesterDate) {
                    document.getElementById(semester + 'SemesterDateError').style.display = 'block';
                    return;
                } else {
                    document.getElementById(semester + 'SemesterDateError').style.display = 'none';
                }
                
                // عرض مؤشر التحميل
                document.getElementById('formSpinner').style.display = 'flex';
                
                // جمع بيانات الطلاب من الجدول
                const studentsTable = document.getElementById(semester + 'SemesterStudents');
                const rows = studentsTable.querySelectorAll('tr');
                const studentsData = [];
                
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length >= 5) {
                        studentsData.push({
                            registrationNumber: cells[0].textContent,
                            firstName: cells[1].textContent,
                            lastName: cells[2].textContent,
                            hizbCount: cells[3].querySelector('input').value,
                            notes: cells[4].querySelector('input').value
                        });
                    }
                });
                
                // هنا يجب إرسال البيانات إلى Firebase
                // هذه مجرد محاكاة للتوضيح
                setTimeout(() => {
                    document.getElementById('formSpinner').style.display = 'none';
                    
                    // عرض رسالة النجاح
                    document.getElementById('successMessage').textContent = 
                        `تم حفظ بيانات ${semester === 'first' ? 'السداسي الأول' : 'السداسي الثاني'} بنجاح لـ ${studentsData.length} طالب/ة`;
                    document.getElementById('successModal').style.display = 'flex';
                    
                    // في الواقع الفعلي، يجب حفظ البيانات في Firebase هنا
                    console.log('بيانات الطلاب:', studentsData);
                }, 1500);
            }
            
            // إغلاق النوافذ المنبثقة
            document.getElementById('successBtn').addEventListener('click', function() {
                document.getElementById('successModal').style.display = 'none';
            });
            
            document.getElementById('errorBtn').addEventListener('click', function() {
                document.getElementById('errorModal').style.display = 'none';
            });
            
            window.addEventListener('click', function(event) {
                if (event.target === document.getElementById('successModal')) {
                    document.getElementById('successModal').style.display = 'none';
                }
                if (event.target === document.getElementById('errorModal')) {
                    document.getElementById('errorModal').style.display = 'none';
                }
            });
            
            // تهيئة Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyAzx-JlJBJxtVZT2cXDtJiHbs6s9K-3hEY",
                authDomain: "tahdiri-dc608.firebaseapp.com",
                databaseURL: "https://tahdiri-dc608-default-rtdb.firebaseio.com",
                projectId: "tahdiri-dc608",
                storageBucket: "tahdiri-dc608.appspot.com",
                messagingSenderId: "795586531700",
                appId: "1:795586531700:web:d693fd56f4bed6aed4dc21",
                measurementId: "G-H57ECZPTT7"
            };

            // Initialize Firebase
            const app = firebase.initializeApp(firebaseConfig);
            const database = firebase.database();
            
            // هنا يمكنك إضافة كود لجلب بيانات الطلاب من Firebase عند اختيار المعلم
            document.getElementById('teacherName').addEventListener('change', function() {
                const teacherId = this.value;
                if (teacherId) {
                    // جلب قائمة الطلاب للمعلم المحدد من Firebase
                    // هذا مثال فقط، يجب تعديله ليناسب هيكل قاعدة البيانات الخاصة بك
                    database.ref('teachers/' + teacherId + '/students').once('value')
                        .then((snapshot) => {
                            const students = snapshot.val();
                            // تحديث الجداول بقائمة الطلاب
                            updateStudentsTables(students);
                        })
                        .catch((error) => {
                            console.error('حدث خطأ أثناء جلب بيانات الطلاب:', error);
                        });
                }
            });
            
            function updateStudentsTables(students) {
                // مسح الجداول الحالية
                document.getElementById('firstSemesterStudents').innerHTML = '';
                document.getElementById('secondSemesterStudents').innerHTML = '';
                
                // تحديث قائمة الطلاب في واجهة المستخدم
                if (students) {
                    Object.keys(students).forEach(studentId => {
                        const student = students[studentId];
                        
                        // إضافة الطالب إلى جدول السداسي الأول
                        const firstSemesterRow = document.createElement('tr');
                        firstSemesterRow.innerHTML = `
                            <td>${student.registrationNumber}</td>
                            <td>${student.firstName}</td>
                            <td>${student.lastName}</td>
                            <td><input type="number" class="hizb-input" min="0" max="60" value="${student.firstSemester?.hizbCount || 0}"></td>
                            <td><input type="text" class="form-control" placeholder="ملاحظات" value="${student.firstSemester?.notes || ''}"></td>
                        `;
                        document.getElementById('firstSemesterStudents').appendChild(firstSemesterRow);
                        
                        // إضافة الطالب إلى جدول السداسي الثاني
                        const secondSemesterRow = document.createElement('tr');
                        secondSemesterRow.innerHTML = `
                            <td>${student.registrationNumber}</td>
                            <td>${student.firstName}</td>
                            <td>${student.lastName}</td>
                            <td><input type="number" class="hizb-input" min="0" max="60" value="${student.secondSemester?.hizbCount || 0}"></td>
                            <td><input type="text" class="form-control" placeholder="ملاحظات" value="${student.secondSemester?.notes || ''}"></td>
                        `;
                        document.getElementById('secondSemesterStudents').appendChild(secondSemesterRow);
                        
                        // إضافة الطالب إلى قائمة الاختيار للتقرير
                        const option = document.createElement('option');
                        option.value = student.registrationNumber;
                        option.textContent = `${student.firstName} ${student.lastName}`;
                        document.getElementById('studentSelect').appendChild(option);
                    });
                }
            }
        });
    </script>
</body>
</html>
